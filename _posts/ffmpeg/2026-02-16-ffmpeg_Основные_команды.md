---
layout: post
title: "FFmpeg. Основные команды ffmpeg"
categories: FFmpeg
---



### Некоторые ключевые опции ffmpeg:

```
-i — задаёт имя исходного файла. Можно указать несколько входных файлов.
-c — указывает кодек для входных и выходных файлов. Например, для видео — -c:v, для аудио — -c:a.
-vf — применяет фильтры к входным и выходным файлам.
-filter_complex — позволяет использовать сложные фильтры с несколькими входами и выходами.
-ss — указывает позицию в видеофайле, с которой будет начинаться кодирование. Формат — в целых секундах или чч:мм:сс.
-t — задаёт длительность видео в целых секундах или чч:мм:сс.
-y — перезаписывает уже существующие файлы без запроса на подтверждение.
-vn - не обрабатывать видео, вся видео информация будет отброшена;
-ar - частота дискретизации, измеряется в герцах, чем больше, тем лучше качество звука;
-ab - устанавливает битрейт аудио;
-ac - устанавливает количество каналов;
-f — force, указываем принудительно формат конечного файла (-f avi).
-loop - задает, что нужно всегда повторять оду и ту же картинку;
-i - задают входящие файлы, картинку и аудиофайл;
-с:v - задает видеокодек, эквивалентно -vc;
-c:a - задает аудиокодек, эквивалентно -ac;
-b:a - задает битрейт аудио, эквивалентно -ab;
-strict experimental - кодек aac для ffmpeg экспериментальный, поэтому чтобы его использовать нужна эта опция.
-с задает кодеки для аудио и видео, в нашем случае просто копировать файлы, ничего не перекодируя.
```

### Опции ffmpeg

*Рассмотрим некоторые полезные опции (в скобках примеры). Если какие-то из опций не будут указаны, то FFmpeg подставит их из значений по умолчанию:*

```
-threads — числовое значение, определяет количество ядер процессора. Что, естественно, отражается на скорости кодирования и операций над файлами. Число 0 устанавливает автоматическое определение доступного числа ядер (-threads 2).
-fs — числовое значение в байтах, килобайтах (k), мегабайтах (M). Регистр приставки важен. Ограничивает размер конечного файла. Полезно для экспериментов над небольшим кусочком видеофайла, чтобы не кодировать весь файл (-fs 5M).
```

### Видео опции:

```
-vcodec — видеокодек, которым будет осуществляться кодирование видео (-vcodec mpeg4).
-vpre — выбираем предустановку для видеокодека. Сначала FFmpeg ищет файлы предустановок в ~/.ffmpeg, затем в /usr/share/ffmpeg или /usr/local/share/ffmpeg, в зависимости от пути установки. Посмотреть самим, какие присутствуют файлы предустановок, можно по этим же путям.
-b — битрейт видеопотока. По умолчанию: 200kb/s (-b 1500).
-bt — толерантность битрейта. По умолчанию: 4000k. При двухпроходном кодировании указывает как далеко в первом проходе можно отклониться от указанного среднего битрейта. Значение не связано с минимальным/максимальным битрейтом. Слишком сильное снижение этого параметра оказывает негативное влияние на качество.
-r — количество кадров в секунду. По умолчанию: 25 (-r 15).
-s — размер фрейма, то есть разрешение выходного видеофайла. По умолчанию определяется размером файла-источника. Может быть задано буквенными сокращениями, например svga означает размер 800×600. Просмотреть все доступные сокращения можно в man ffmpeg. (-s 640×480 или -s vga).
-aspect — числовые значения, определяет соотношение сторон выходного файла (-aspect 4:3 или -aspect 1.3333).
-croptop
-cropbottom
-cropleft
-cropright — обрезка кадров сверху, снизу, слева, справа. Значения указываются в пикселях. Может использоваться, например, для удаления черных полос (-croptop 15). В некоторых версиях ffmpeg данные опции могут быть удалены и вместо них используется опция -vf crop=width:height:x:y. Подробнее о ней в соответствующем разделе ниже.
-pass — количество проходов при кодировании, 1 или 2 (-pass 2).
-g — размер группы кадров, после которой следует ключевой кадр. Например -g 300устанавливает по одному ключевому кадру каждые 10 секунд, при скорости исходного видеофайла 29.97fps. 30 кадров в секунду * на 10 секунд = значение опции 300 (примерное значение для рипа DVD-файла). Чем меньше битрейт и количество кадров в секунду, тем меньше должно быть это значение.
-deinterlace — удаление «гребенки».
```

### Аудио опции:

```
-ar — устанавливает частоту дискретизации звука. По умолчанию: 44100Гц (-ar 22050).
-ab — битрейт звуковой дорожки. По умолчанию: 64kb (-ab 256k).
-ac — число каналов звуковой дорожки. По умолчанию, для входящих потоков это значение равно 1, для исходящих равно числу каналов исходного файла. Другими словами, если вы делаете захват звука, то число каналов по умолчанию 1, а если берете звук из видеофайла, например, то число каналов по умолчанию будет равно исходнику (-ac 2).
-an — кодирование видео без звуковой дорожки.
-acodec — аудиокодек, которым будет осуществляться кодирование звука (-acodec flac).
-apre — набор предустановок для аудиокодека.
```

