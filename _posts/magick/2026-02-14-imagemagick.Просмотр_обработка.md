---
layout: post
title: ImageMagick. Утилиты
categories: Magick
---


### Пакет ImageMagick входит почти в каждый дистрибутив Linux.

Это набор консольных утилит и библиотек для просмотра и обработки изображений.

ImageMagick ориентирован на работу в консоли, хотя и имеет свой собственный графический интерфейс - `Command Widget`.

С ImageMagick создаются динамические изображения для Web страниц:

производится трансформация изображений: изменение размеров, цвета, вращение
создаются надписи на изображении и комментарии получают снимки экрана, окна, выделенной области добавляются спецэффекты для искажения изображения используют и сохраняют изображения всех популярных форматов TIFF, JPEG, PNG, PDF, PhotoCD, GIF...

- всего 89 форматов просматриваются, указанные в URL изображения
строится гистограмма компонентов изображения
- ImageMagick может быть собран и поставлен на всех Unix и Linux,системах Wndows.
- Вызов ImageMagick - по имени пакета (без пробела) или имени его утилиты из командной строки.
- Утилиты ImageMagick находятся в каталоге /usr/local/bin
- Документация - в каталоге /usr/X11R6/share/ImageMagick .

### Утилиты ImageMagick и их использование

Каждая утилита имеет несколько десятков опций, а опции - ключи и, возможно, параметры. 

Весь список опций находится на соответствующих man страницах. 

Для получения краткой информации о пакете и комбинированного списка всех опций, используемых утилитами набрать в консоли:

```
man ImageMagick
```
Информация о выбранной утилите:

```
man <имя_утилиты>
или
<имя_утилиты> -help
```

### display

Работает на всех рабочих станциях с активным X сервером.
Это загрузка, просмотр, запись, уменьшение/увеличение размеров, вращение и трансформация, изменение цвета, контрастности, устранение дефектов изображения, операции со слайдами.

При необходимости `display` вызывает другие утилиты `ImageMagick`.

### Просмотр графического файла из mc (Midnight Commander):

находясь в каталоге с отмеченными файлом, вызвать меню F2 и выбрать Do something with current file. В окне ввести display. Откроется окно ImageMagick с изображением из отмеченного файла.

Ввод имени этой утилиты из командной строки так же вызывает окно ImageMagick.

### Функции кнопок мыши:

- 1 Левая кнопка - открывает отдельное меню Commands из Command Widget
- 2 Средняя кнопка - открывает окно Magnify 3x - "лупа", увеличение указанного курсором участка, точки изображения с информацией о них. Эмуляция средней кнопки мыши - одновременное нажатие левой и правой кнопок.
- 3 Правая кнопка - меню Short Cuts - набор команд утилиты display. Здесь кнопку надо придержать.

### Создание снимка области экрана

Меню Short Cuts => правая кнопка => выбрать Open =>

Появится окно. Нажать Grab =>

Новое окно. Указать задержку, после которой создается снимок => oпять нажать Grab.

Курсор изменяет форму. Обвести область на экране и щелчком получить ее снимок.

Двойной щелчок на окне дает снимок этого окна.

### Из контекстного меню display:

Сохранение снимка - Save

В открывшемся окне - Format. Выбрать формат изображения: в списке почти сотня поддерживаемых форматов.

Левой кнопкой - на окне display. Откроется Commands - меню и редактор изображений.

Эффекты и фильтры здесь представляют собой фронтенды к консольным утилитам из состава пакета ImageMagick. 

*Для создания снимков экрана вызывалась утилита import.*

### Получение информации об изображении:

Правая кнопка мыши => Short Cuts => Image Info => окно с подробной технической информацией о характеристиках точек изображения.

### Вызов окна с гистограммой изображения:

Левая кнопка мыши => Commands => Miscellany => Show Histogram

### Возможно использование "горячих" клавиш в работе. 

Это только часть из них:

```
Ctl-O загрузка изображения из файла
space переход к следующему изображению
Ctl-S сохранение в файл
Ctl-D удаление
Ctl-Q сброс всех картинок и выход из программы
Ctl-Z отменить последнюю трансформацию
Ctl-X вырезать область из изображения
Ctl-C копировать
Ctl-V вставить
< и > уменьшить и увеличить размер вдвое
. точка, вернуться к оригинальному размеру
C crop, обрезать изображение
[ chop, штамп
H и V flop и flip, зеркальные отображения
/ и \ вращение на 90 градусов
Shft-? получить информацию об изображении
Shft-N гистограмма
Shft-P предосмотр
F1 получить help страницу
```

В `ImageMagick` к каждому действию существует доступ через комбинацию клавиш. Вся информация о них - на man страницах.

### display в качестве консольной утилиты:

Просмотр всех *.jpg изображений - visual image directory:

```
display *.jpg'
```

Просмотр картинки с WWW:

```
display ftp://wizards.dupont.com/images/cockatoo.jpg
```

Получение гистограммы изображения в файле file.jpg :

```
convert file.jpg HISTOGRAM:- | display -
```

### convert

преобразование форматов, создание анимации, манипуляция над изображениями: вращение, изменение размера, цветовой гаммы, разрешения в точках на дюйм и т.д.
Изменение формата файла с *.jpg на *.bmp. Тип файла распознается программой по расширению:

```
convert file.jpg file.bmp
```

Вертикально перевернуть изображение в file.bmp с конвертацией в JPEG:

```
convert -flip file.bmp file.jpg
```

Cоздать ani.gif анимацию из всех *.bmp файлов текущего каталога cо сменой файлов в 20/100 сек:

```
convert -delay 20 *.bmp ani.gif
```

Преобразовать image.tiff в PostScript документ формата А4 с расположением изображения в левом нижнем углу:

```
convert -page A4+0+0 image.tiff document.ps
```

На изображении magic.jpg от точки 100*100 сделать надпись "IMAGE" синим цветом, шрифтом helvetic. Результат записать в I_magic.jpg:

```
convert -font helvetica -pen blue -draw "text 100,100 IMAGE" magic.jpg I_magic.jpg
```

Задание типа компрессии (None, BZip, Fax, Group4, JPEG, Lossless, LZW, RLE и Zip) для форматов, которые поддерживают сжатие числом - от 0 до 100 - качества сжатия (для форматов .jpeg, .miff и .png):

```
convert -compress JPEG -quality число image
```

### identify

информация о параметрах изображения:

```
identify -verbose имя_файла
```

### import

запись образа окна, выбранной области экрана в файл. Имеется около 20 опций.

Сделать снимок и записать его в файл shot.png:

```
import shot.png
```

Сделать снимок окна с записью в shot.bmp. Окно выбирается одинарным щелчком под крестиком-курсором:
```
import -window shot.png
```
### animate

просмотр группы изображений. Показ слайд-шоу из файлов по маске в текущем каталоге с интервалом просмотра 100 сотых долях секунды (здесь - одна секунда):

```
animate -delay 100 *.png
```

### montage

- монтаж; создание изображения из нескольких.

Объединить отдельные gif_image вместе (без фрейма, без тени, без метки):

```
montage +frame +shadow +label -tile 5x1 -geometry 50x50+0+0 *.png joined.png
```

### mogrify

трансформация изображения или их последовательности (без применения скриптов). Конвертирует несколько файлов:

```
mogrify -format jpeg *.png
```

### composite

комбинирование, наложение изображений.
Найти отличие между изображениями в сериях и записать результат в файл difference.miff :

```
composite -compose difference series.1 series.2 difference.miff
```


