---
layout: post
title: SSH. Соединения системного блока(FreeBSD) и ноутбука(Linux)
categories: Программы
---

Для соединения системного блока(FreeBSD) и ноутбука(Linux) по SSH выполните следующие шаги.

#### Подготовка сервера (FreeBSD)


1. **Установите OpenSSH‑сервер** (если не установлен):

   ```
   sudo pkg install openssh
   ```

2. **Запустите сервис SSH**:

   ```
   sudo service sshd start
   ```

3. **Включите автозапуск при загрузке**:

   ```
   sudo sysrc sshd_enable="YES"
   ```

4. **Проверьте статус сервиса**:

   ```
   sudo service sshd status
   ```
 <a href="/assets/images/ssh_bsd.jpg" target="_blank">
    <img src="/assets/images/ssh_bsd.jpg" alt="FreeBSD 15 JWM">
</a>  

5. **Убедитесь, что порт 22 открыт** (по умолчанию для SSH). Если используется файрвол (`pf` или `ipfw`), разрешите трафик:

   * Для `pf`: добавьте в `/etc/pf.conf` строку:
   
     ```
     pass in proto tcp from any to any port 22
     ```
     Затем перезапустите `pf`:
     
     ```
     sudo pfctl -f /etc/pf.conf
     ```
   * Для `ipfw`:
   
     ```
     sudo ipfw add allow tcp from any to any 22 in
     ```

#### Подготовка клиента (Linux)

1. **Убедитесь, что SSH‑клиент установлен** (обычно предустановлен):

   ```
   ssh -V
   ```
   Если не установлен:
   
   ```
   sudo apt-get install openssh-client
   ```

2. **Узнайте IP‑адрес сервера (FreeBSD)**:

   * На сервере выполните:
   
     ```
     ifconfig
     ```
     
   * Найдите интерфейс (например, `em0` или `igb0`) и строку `inet` — это ваш IP (например, `192.168.1.100`).

#### Подключение с ноутбука (Linux) к серверу (FreeBSD)

1. **Откройте терминал на ноутбуке** и выполните команду:

   ```
   ssh username@server_ip
  ```
  
   Где:
   
   * `username` - имя пользователя на FreeBSD,
   * `server_ip` - IP‑адрес FreeBSD (например, `192.168.1.100`).

   Пример:
   
   ```
   ssh user@192.168.1.100
   ```

2. **При первом подключении** система запросит подтверждение:

   ```
   Are you sure you want to continue connecting (yes/no)?
   ```
   
   Введите `yes` и нажмите Enter.

3. **Введите пароль пользователя** FreeBSD. 

*Пароль не отображается при вводе - это нормально*.

4. Если всё прошло успешно, вы увидите командную строку FreeBSD.

### Дополнительные настройки (опционально)

#### Аутентификация по ключам (без пароля)

1. На ноутбуке (Alt Linux) сгенерируйте пару ключей:

   ```
   ssh-keygen -t rsa -b 4096
   ```
   
   *нажмите Enter на всех запросах, чтобы использовать стандартные пути и без пароля для ключа*.

2. Скопируйте публичный ключ на сервер:

   ```
   ssh-copy-id username@server_ip
   ```
   
   Пример:
   
   ```
   ssh-copy-id user@192.168.1.100
   ```

3. Теперь можно подключаться без ввода пароля:

   ```
   ssh username@server_ip
   ```

#### Изменение порта SSH (для безопасности)

1. На сервере (FreeBSD) откройте файл конфигурации:

   ```
   sudo vi /etc/ssh/sshd_config
   ```

2. Найдите строку `Port 22` и измените на другой порт (например, `2222`):

   ```
   Port 2222
   ```

3. Сохраните файл и перезапустите SSH:

   ```
   sudo service sshd restart
   ```

4. При подключении указывайте порт:

   ```
   ssh -p 2222 username@server_ip
   ```

#### Проверка соединения

* Убедитесь, что оба устройства в одной сети (например, подключены к одному роутеру).
* Проверьте, что IP‑адреса корректны.
* Если подключение не удаётся, проверьте:
  * Работает ли SSH‑сервер на FreeBSD (`sudo service sshd status`).
  * Не блокирует ли файрвол порт 22 (или указанный вами порт).
  * Правильность IP‑адреса и имени пользователя.

#### Итог

После выполнения этих шагов вы сможете:

* Выполнять команды на FreeBSD с ноутбука.
* Передавать файлы через `scp` (например, `scp file.txt user@192.168.1.100:/home/user`).
* Работать с сервером удалённо.
