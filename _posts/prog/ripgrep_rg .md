**Ripgrep (rg)** — современный инструмент поиска текста в файлах, написанный на языке Rust. Он использует регулярные выражения и оптимизирован для высокой скорости работы, что делает его особенно полезным при работе с большими проектами и базами кода. `Ripgrep` по умолчанию учитывает правила `.gitignore`, игнорирует скрытые файлы, директории и бинарные файлы, что ускоряет поиск.

#### Основные характеристики

- **Рекурсивный поиск.** По умолчанию ripgrep рекурсивно обходит все поддиректории.
- **Поддержка регулярных выражений.** Использует движок на основе конечных автоматов, обеспечивающий линейное время поиска. Однако некоторые продвинутые функции (например, обратные ссылки и произвольные look-around) не поддерживаются по умолчанию. Если ripgrep собран с поддержкой PCRE2, эти функции можно включить с помощью флага `-P`./rg.1.html)
- **Игнорирование `.gitignore`.** По умолчанию ripgrep учитывает правила игнорирования из файла 
- **Поддержка кодировок.** Автоматически определяет кодировки (например, UTF-8, UTF-16, latin-1 и др.). Для принудительного указания кодировки используется флаг `-E` или `--encoding`.
- **Поиск в сжатых файлах.** Поддерживает поиск в архивах (brotli, bzip2, gzip, lz4, lzma, xz, zstandard) с флагом `-z` или `--search-zip`.
- **Многопоточность.** Использует параллельный поиск по директориям, что ускоряет обработку больших объёмов данных.

#### Базовый синтаксис

```bash
rg [OPTIONS] PATTERN [PATH...]
```

Где:

- `PATTERN` — шаблон поиска (регулярное выражение или строка);
- `PATH` — файл или директория для поиска (если не указан, используется текущая директория).

## Установка

Ripgrep не предустановлен по умолчанию, но доступен в репозиториях большинства дистрибутивов Linux. 

Например:

- для Debian/Ubuntu: `sudo apt install ripgrep`;
- для Fedora/Red Hat: `sudo dnf install ripgrep`;
- для Arch Linux: `pacman -S ripgrep`.

#### Ключевые опции

| Опция | Описание |
|-------|----------|
| `-i`, `--ignore-case` | Игнорировать регистр при поиске |
| `-v`, `--invert-match` | Инвертировать поиск (выводить строки, не содержащие шаблон) |
| `-l`, `--files-with-matches` | Выводить только имена файлов с совпадениями |
| `-L`, `--files-without-match` | Выводить имена файлов без совпадений |
| `-n` | Показывать номера строк с совпадениями |
| `-o`, `--only-matching` | Выводить только совпавшую часть строки, а не всю строку |
| `-c`, `--count` | Выводить количество совпадений |
| `-C N`, `--context N` | Выводить N строк контекста до и после совпадения |
| `-A N`, `--after-context N` | Выводить N строк после совпадения |
| `-B N`, `--before-context N` | Выводить N строк до совпадения |
| `-F`, `--fixed-strings` | Трактовать шаблон как обычную строку, а не регулярное выражение |
| `-P`, `--pcre2` | Включить поддержку PCRE2 (обратные ссылки, look-around) |
| `-t`, `--type` | Ограничить поиск файлами определённого типа (например, `-t cpp` для C++) |
| `-g`, `--glob` | Использовать шаблоны глобуса для включения/исключения файлов (например, `-g '!tests/*'` для исключения директории `tests`) |
| `-u`, `--no-ignore` | Отключить игнорирование `.gitignore` |
| `-a`, `--text` | Обрабатывать бинарные файлы как текстовые |
| `--json` | Выводить результаты в формате JSON Lines |

#### Примеры использования

- Простой поиск слова во всех файлах текущей директории:

   ```bash
   rg 'utils'
   ```

- Игнорирование регистра:

   ```bash
   rg -i 'Utils'
   ```

- Поиск в конкретных типах файлов (например, C++):

   ```bash
   rg --type cpp 'int main'
   ```

- Использование регулярного выражения:

   ```bash
   rg '^[ \t]*#include'
   ```

   Ищет строки, начинающиеся с `#include`, возможно, с предшествующими пробелами или табуляцией.

- Поиск с контекстом:

   ```bash
   rg -C 3 'failed'
   ```

   Выводит 3 строки контекста вокруг каждого совпадения.

- Исключение определённых каталогов:

   ```bash
   rg 'TODO' --glob '!tests/*'
   ```

   Ищет `TODO`, но исключает файлы из директории `tests`.

- Отображение только имён файлов:

   ```bash
   rg -l 'time'
   ```

- Предварительный просмотр поиска и замены:

   ```bash
   rg 'old' --replace 'new'
   ```

   *Показывает, как будет выглядеть замена `old` на `new`, но не изменяет файлы*

- Поиск в сжатых архивах:

   ```bash
   rg -z 'pattern' archive.gz
   ```

#### Дополнительные возможности

- **Конфигурационные файлы.** Ripgrep поддерживает конфигурационные файлы. Переменная `RIPGREP_CONFIG_PATH` позволяет указать путь к файлу с настройками. 
- **Поиск по нескольким шаблонам.** Можно использовать оператор `|` для поиска нескольких шаблонов одновременно, например: `rg 'pattern1|pattern2'`.
- **Сортировка результатов.** Опции `--sort` и `--sortr` позволяют сортировать результаты по пути файла, времени модификации и т. д..

#### Сравнение с grep

| Критерий | grep | ripgrep |
|----------|------|---------|
| Скорость | Базовая | Очень высокая |
| Учёт `.gitignore` | Нет | Да |
| Мультипроцессорная обработка | Нет | Да |
| Поддержка кодировок | Ограниченная | Широкая |
| Кроссплатформенность | Да (POSIX) | Да (Windows, macOS, Linux) |

`Ripgrep` — отличный выбор для сценариев, где важна скорость и удобство работы с большими проектами. Однако если требуется максимальная портативность или специфические функции, которые есть только в grep, последний может быть предпочтительнее.
