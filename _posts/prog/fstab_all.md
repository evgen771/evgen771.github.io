**fstab** (сокр. от англ. *file systems table*) — конфигурационный файл в UNIX-подобных системах, который содержит информацию о различных файловых системах и устройствах хранения информации. Он определяет, как диск (раздел) будет использоваться или интегрирован в систему. Полный путь к файлу — `/etc/fstab`.

Файл можно открыть в любом текстовом редакторе, но редактировать его возможно только от имени суперпользователя, так как файл является важной, неотъемлемой частью системы.

#### Структура fstab

Каждая запись в файле (кроме комментариев) представляет файловую систему и имеет шесть полей, которые разделяются пробелом или табуляцией:

- **`<device-spec>` (устройство)** — указывает, что монтировать. Это может быть имя устройства, его UUID, метка или путь к файлу-образу.
- **`<mount-point>` (точка монтирования)** — путь, по которому будет смонтировано устройство.
- **`<fs-type>` (тип файловой системы)** — тип файловой системы монтируемого устройства.
- **`<options>` (опции)** — параметры монтирования.
- **`<dump>`** — используется утилитой `dump` для определения, когда делать резервную копию.
- **`<pass>`** — определяет порядок проверки файловой системы утилитой `fsck` при загрузке.

Строки, начинающиеся с символа `#`, являются комментариями. Пустые строки игнорируются. В конце файла требуется одна пустая строка.

### Поля подробно

#### `<device-spec>` (устройство)

Может быть указано несколькими способами:

- имя устройства с префиксом `/dev/` (например, `/dev/sda1`);
- UUID (универсальный уникальный идентификатор раздела, например, `UUID=123e4567-e89b-12d3-a456-426614174000`);
- метка (LABEL, например, `LABEL=MyLabel`);
- для GPT-дисков — PARTUUID или PARTLABEL.

Использование `UUID` считается наиболее предпочтительным способом, так как он не меняется при переподключении диска к другому порту. 

- Узнать `UUID` можно с помощью команд `blkid` или `lsblk -f`

#### `<mount-point>` (точка монтирования)

Каталог, в который будет смонтировано устройство. Должен существовать и быть пустым перед монтированием. Например, `/mnt/data`, `/home`, `/`. 

#### `<fs-type>` (тип файловой системы)

Примеры типов: `ext4`, `xfs`, `ntfs`, `vfat`, `swap`, `proc`, `cifs`, `nfs` и др.. Для сетевых файловых систем (например, CIFS или NFS) указывается соответствующий протокол.

Ключевое слово `auto` позволяет автоматически определять тип файловой системы. Это удобно для съёмных устройств, дисководов и CD-дисков.

#### `<options>` (опции)

Параметры монтирования. Если используются все значения по умолчанию, то используется специальный ключ `defaults`. Если хоть одна опция задана явно, то `defaults` указывать не нужно.

Некоторые распространённые опции:

- `auto` — файловая система монтируется при загрузке автоматически или после выполнения команды `mount -a`.
- `noauto` — файловая система может быть смонтирована только вручную.
- `exec` — позволяет исполнять бинарные файлы на разделе диска.
- `noexec` — запрещает исполнение бинарных файлов.
- `suid`/`nosuid` — разрешает/запрещает использование битовых идентификаторов пользователей или групп.
- `rw` — монтирование в режиме «чтение-запись».
- `ro` — монтирование в режиме «только чтение».
- `user` — позволяет любому пользователю монтировать устройство.
- `nofail` — игнорирует ошибку, если устройство не найдено при загрузке.

Полный список опций можно посмотреть в мануале к команде `mount` (`man mount`).

#### `<dump>`

Используется утилитой `dump` для определения, нужно ли создавать резервную копию с этого устройства. В большинстве случаев устанавливается в `0` (отключено).

#### `<pass>`

Определяет порядок проверки файловой системы утилитой `fsck` при загрузке:

- `0` — проверка отключена;
- `1` — проверять с высоким приоритетом (рекомендовано только для корневого раздела `/`);
- `2` — проверять с низким приоритетом (для остальных разделов).

*Для файловой системы `btrfs` всегда следует указывать `0`, даже если она используется в качестве корневой*.

### Примеры

#### Пример 1:

```
UUID=7211313d-8b5e-4b96-be63-5dbbeb97f590 / ext4 errors=remount-ro 0 1
```
Монтирует корневой раздел (`/`) с файловой системой `ext4` по UUID. При ошибке монтирования перемонтирует в режиме только для чтения (`errors=remount-ro`). Проверка при загрузке — с высоким приоритетом (значение `1` для корневого раздела).

#### Пример 2:

```
//192.168.1.100/share /mnt/network_drive cifs user,rw,credentials=/root/.smbclient 0 0
```
Монтирует сетевой ресурс по протоколу CIFS. Точка монтирования — `/mnt/network_drive`. Опции: `user` (может монтировать любой пользователь), `rw` (чтение и запись), `credentials` (файл с логином и паролем).

#### Пример 3:

```
/dev/sda3 /home xfs rw,suid,exec,auto,nouser,async 0 2
```
- Монтирует раздел `/dev/sda3` в каталог `/home` с файловой системой `xfs`. 
- Опции: чтение-запись (`rw`), разрешение suid/sgid (`suid`), выполнение бинарных файлов (`exec`), автоматическое монтирование при загрузке (`auto`), запрет монтирования обычным пользователем (`nouser`), асинхронные операции ввода-вывода (`async`).

#### Пример 4:

```
proc /proc proc defaults 0 0
```
Монтирует виртуальную файловую систему `proc` в каталог `/proc` с опциями по умолчанию.


#### Важные замечания

- Для отчуждаемых устройств (USB-накопители, карты памяти) не рекомендуется описывать параметры монтирования в `fstab`, так как это может привести к ошибкам при загрузке, если устройство не подключено.
- При редактировании `fstab` рекомендуется создавать резервную копию файла перед изменениями (например, `sudo cp /etc/fstab /etc/fstab_backup`).
- Проверить корректность настроек можно командой `mount -a`, которая смонтирует все файловые системы, перечисленные в `fstab`.
- Для сетевых файловых систем (CIFS, NFS) часто требуется дополнительная настройка аутентификации и прав доступа.

